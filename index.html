<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- Primary SEO -->
  <title>SysAdmin Quick Tools — JSON↔YAML, CSV→Markdown, Epoch, Base64, Diff, Password Check</title>
  <meta name="description" content="Fast client-side utilities for sysadmins: JSON↔YAML converter, CSV→Markdown table, epoch timestamp converter, Base64/URL encode-decode, quick text diff, and an offline password strength checker. Nothing is uploaded." />
  <link rel="canonical" href="https://www.spriteguide.com/" />
  <meta name="robots" content="index,follow,max-image-preview:large,max-snippet:-1,max-video-preview:-1" />
  <meta name="theme-color" content="#0b1020" />

  <!-- Favicons (optional files) -->
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">

  <!-- Open Graph / Social -->
  <meta property="og:site_name" content="SysAdmin Quick Tools" />
  <meta property="og:title" content="SysAdmin Quick Tools" />
  <meta property="og:description" content="Client-side ops utilities: JSON↔YAML, CSV→Markdown, Epoch, Base64/URL, Diff, and offline password strength. Nothing is uploaded." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://www.spriteguide.com/" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="SysAdmin Quick Tools" />
  <meta name="twitter:description" content="Client-side ops utilities: JSON↔YAML, CSV→Markdown, Epoch, Base64/URL, Diff, and offline password strength. Nothing is uploaded." />

  <!-- Structured Data (JSON-LD) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebApplication",
    "name":"SysAdmin Quick Tools",
    "url":"https://www.spriteguide.com/",
    "applicationCategory":"DeveloperApplication",
    "operatingSystem":"Any",
    "description":"Fast client-side utilities for sysadmins: JSON↔YAML converter, CSV→Markdown table, epoch converter, Base64/URL encoder/decoder, quick text diff, and offline password strength checker. Nothing is uploaded.",
    "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"}
  }
  </script>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-5V53VWPED5"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-5V53VWPED5');
  </script>

  <style>
    :root{
      --bg:#0b1020;
      --panel:#101a33;
      --panel2:#0f1730;
      --border:#223058;
      --text:#d7def0;
      --muted:#aab6d6;
      --accent:#7aa2ff;
      --good:#3ddc97;
      --warn:#ffcc66;
      --bad:#ff6b6b;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 14px;
      --radius2: 10px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background: radial-gradient(1200px 700px at 20% 0%, rgba(122,162,255,.20), transparent 60%),
                  radial-gradient(900px 600px at 85% 20%, rgba(61,220,151,.12), transparent 55%),
                  var(--bg);
      line-height:1.35;
    }
    a{color:var(--accent); text-decoration:none}
    .wrap{max-width:1100px;margin:0 auto;padding:22px 16px 50px}
    header{
      display:flex;align-items:center;justify-content:space-between;
      gap:12px;flex-wrap:wrap;margin-bottom:14px;
    }
    .title{
      display:flex;align-items:baseline;gap:10px;flex-wrap:wrap;
    }
    h1{font-size:22px;margin:0;font-weight:700;letter-spacing:.2px}
    .pill{
      font-size:12px;color:var(--muted);
      border:1px solid var(--border);
      background:rgba(16,26,51,.55);
      padding:6px 10px;border-radius:999px;
    }
    .subhead{
      margin:10px 0 18px;
      color:var(--muted);
      text-align:center;
    }
    .topbar{
      display:flex;gap:10px;align-items:center;justify-content:flex-end;
    }
    .btn{
      appearance:none;border:1px solid var(--border);
      background:linear-gradient(180deg, rgba(122,162,255,.14), rgba(122,162,255,.06));
      color:var(--text);
      padding:9px 12px;border-radius:10px;
      cursor:pointer;
      box-shadow: 0 8px 20px rgba(0,0,0,.18);
      font-weight:600;
      transition:transform .06s ease, border-color .2s ease;
    }
    .btn:hover{border-color:#2f4279}
    .btn:active{transform:translateY(1px)}
    .btn.secondary{
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
    }
    .btn.small{padding:7px 10px;font-size:12px;border-radius:9px}
    .btn.good{background:linear-gradient(180deg, rgba(61,220,151,.18), rgba(61,220,151,.06))}
    .btn.warn{background:linear-gradient(180deg, rgba(255,204,102,.16), rgba(255,204,102,.06))}
    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }
    .card{
      background:linear-gradient(180deg, rgba(16,26,51,.85), rgba(15,23,48,.85));
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    details{border-radius:var(--radius)}
    summary{
      list-style:none;
      display:flex;align-items:center;justify-content:space-between;
      gap:14px;
      padding:14px 16px;
      cursor:pointer;
      user-select:none;
      border-bottom:1px solid rgba(34,48,88,.65);
      background:rgba(10,16,32,.25);
    }
    summary::-webkit-details-marker{display:none}
    .sum-left{display:flex;align-items:center;gap:10px}
    .icon{
      width:28px;height:28px;border-radius:9px;
      display:grid;place-items:center;
      border:1px solid rgba(122,162,255,.25);
      background:rgba(122,162,255,.10);
      font-weight:800;
      color:var(--accent);
      font-family:var(--mono);
      font-size:13px;
    }
    .sum-title{font-weight:800}
    .chev{opacity:.7}
    details[open] .chev{transform:rotate(180deg)}
    .content{padding:14px 16px 16px}
    .row{
      display:grid;
      grid-template-columns: 1fr 44px 1fr;
      gap:12px;
      align-items:stretch;
    }
    .row.single{grid-template-columns: 1fr;}
    .row.two{grid-template-columns: 1fr 1fr;gap:12px;}
    @media (max-width: 900px){
      .row{grid-template-columns:1fr;}
      .arrow{display:none}
    }
    label{
      display:flex;align-items:center;justify-content:space-between;
      gap:10px;
      margin:0 0 8px;
      color:var(--muted);
      font-size:13px;
    }
    textarea, input[type="text"], input[type="password"]{
      width:100%;
      border:1px solid rgba(34,48,88,.85);
      background:rgba(8,12,25,.55);
      color:var(--text);
      border-radius:12px;
      padding:12px;
      font-family:var(--mono);
      font-size:13px;
      outline:none;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.15);
    }
    textarea{min-height:170px;resize:vertical}
    .arrow{
      display:grid;place-items:center;
      color:rgba(215,222,240,.35);
      font-size:28px;
      user-select:none;
    }
    .actions{
      margin-top:10px;
      display:flex;gap:10px;flex-wrap:wrap;align-items:center;
      justify-content:space-between;
    }
    .left-actions, .right-actions{display:flex;gap:10px;flex-wrap:wrap;align-items:center;}
    .hint{font-size:12px;color:var(--muted)}
    .status{
      font-size:12px;color:var(--muted);
      padding:8px 10px;border:1px dashed rgba(34,48,88,.85);
      border-radius:10px;background:rgba(8,12,25,.35);
    }
    .status.good{border-color:rgba(61,220,151,.45); color:rgba(61,220,151,.95)}
    .status.bad{border-color:rgba(255,107,107,.45); color:rgba(255,107,107,.95)}
    .status.warn{border-color:rgba(255,204,102,.55); color:rgba(255,204,102,.95)}
    .adslot{
      margin:16px 0 0;
      border:1px dashed rgba(34,48,88,.75);
      border-radius:12px;
      padding:12px;
      color:rgba(170,182,214,.75);
      font-size:12px;
      text-align:center;
      background:rgba(8,12,25,.25);
    }
    .mini{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 700px){
      .mini{grid-template-columns:1fr}
    }
    .kpi{
      border:1px solid rgba(34,48,88,.85);
      background:rgba(8,12,25,.35);
      border-radius:12px;padding:12px;
      font-family:var(--mono);
    }
    .kpi b{font-family:var(--sans)}
    .diffout{
      border:1px solid rgba(34,48,88,.85);
      background:rgba(8,12,25,.35);
      border-radius:12px;padding:12px;
      font-family:var(--mono);
      white-space:pre-wrap;
      min-height:120px;
      overflow:auto;
    }
    .line{display:block;padding:1px 6px;border-radius:8px;margin:0 0 2px}
    .line.same{color:rgba(215,222,240,.75)}
    .line.diff{background:rgba(255,204,102,.12); outline:1px solid rgba(255,204,102,.25)}
    .line.onlyA{background:rgba(255,107,107,.10); outline:1px solid rgba(255,107,107,.22)}
    .line.onlyB{background:rgba(61,220,151,.10); outline:1px solid rgba(61,220,151,.22)}
    footer{
      margin-top:18px;
      color:rgba(170,182,214,.75);
      font-size:12px;
      text-align:center;
    }
    .togglebar{
      display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:center;
      margin:12px 0 0;
    }
    .chip{
      border:1px solid rgba(34,48,88,.85);
      background:rgba(8,12,25,.35);
      color:var(--muted);
      padding:7px 10px;border-radius:999px;
      font-size:12px;cursor:pointer;
      user-select:none;
    }
    .chip:hover{border-color:#2f4279;color:var(--text)}
    noscript{
      display:block;
      max-width:900px;
      margin:12px auto 0;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid rgba(255,204,102,.45);
      background:rgba(255,204,102,.08);
      color:rgba(255,204,102,.95);
      text-align:center;
      font-size:13px;
    }

    /* Password checker visuals */
    .pwbar{
      height:10px;
      width:100%;
      border-radius:999px;
      background:rgba(34,48,88,.75);
      overflow:hidden;
      border:1px solid rgba(34,48,88,.95);
    }
    .pwbar > div{
      height:100%;
      width:0%;
      background:rgba(255,107,107,.9);
      transition:width .15s ease;
    }
    .pwgrid{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:12px;
      margin-top:12px;
    }
    @media (max-width: 900px){
      .pwgrid{grid-template-columns:1fr}
    }
    .pwbox{
      border:1px solid rgba(34,48,88,.85);
      background:rgba(8,12,25,.35);
      border-radius:12px;
      padding:12px;
    }
    .pwbox b{font-family:var(--sans)}
    .pwlist{
      margin:8px 0 0;
      padding-left:16px;
      color:var(--muted);
      font-size:12px;
      line-height:1.4;
    }
    .badge{
      display:inline-block;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid rgba(34,48,88,.85);
      background:rgba(8,12,25,.35);
      font-size:12px;
      color:var(--muted);
      margin-left:8px;
    }

    /* ---- Ticker bar ---- */
    .ticker{
      margin:10px 0 0;
      border:1px solid rgba(34,48,88,.85);
      border-radius:14px;
      background:linear-gradient(180deg, rgba(16,26,51,.65), rgba(8,12,25,.35));
      box-shadow: 0 8px 22px rgba(0,0,0,.22);
      padding:10px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .tick-left{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      min-width:240px;
    }
    .tick-item{
      display:flex;
      gap:8px;
      align-items:center;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid rgba(34,48,88,.75);
      background:rgba(8,12,25,.30);
      font-family:var(--mono);
      font-size:12px;
      color:rgba(215,222,240,.95);
    }
    .tick-item b{
      font-family:var(--sans);
      font-size:12px;
      color:var(--muted);
      font-weight:700;
    }
    .tick-actions{
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .tick-badge{
      font-family:var(--sans);
      font-size:12px;
      color:var(--muted);
      padding:8px 10px;
      border-radius:12px;
      border:1px dashed rgba(34,48,88,.85);
      background:rgba(8,12,25,.25);
      white-space:nowrap;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1>SysAdmin Quick Tools</h1>
        <div class="pill">Runs locally in your browser — nothing is uploaded.</div>
      </div>
      <div class="topbar">
        <button class="btn secondary small" id="openAllBtn" title="Expand all tools">Open all</button>
        <button class="btn secondary small" id="closeAllBtn" title="Collapse all tools">Close all</button>
        <button class="btn secondary small" id="clearAllBtn" title="Clear all fields">Clear all</button>
      </div>
    </header>

    <!-- LIVE TICKER -->
    <div class="ticker" aria-label="Live sysadmin ticker">
      <div class="tick-left">
        <div class="tick-item" title="Current UTC time (updates locally)">
          <b>UTC</b> <span id="tickUtc">—</span>
        </div>
        <div class="tick-item" title="Epoch seconds (updates locally)">
          <b>Epoch</b> <span id="tickEpochS">—</span>
        </div>
        <div class="tick-item" title="Epoch milliseconds (updates locally)">
          <b>ms</b> <span id="tickEpochMs">—</span>
        </div>
      </div>

      <div class="tick-actions">
        <button class="btn secondary small" id="tickCopyUtcBtn" title="Copy UTC timestamp">Copy UTC</button>
        <button class="btn secondary small" id="tickCopyEpochBtn" title="Copy epoch seconds">Copy epoch</button>
        <div class="tick-badge" id="tickPatch">Patch Tuesday: —</div>
      </div>
    </div>

    <noscript>
      This page needs JavaScript to run the tools. Your pasted data still stays local — it’s just processed in-browser.
    </noscript>

    <div class="subhead">
      Fast, private ops utilities for 2026: converters, timestamp tools, quick diffs, and password strength checks you can keep pinned.
    </div>

    <div class="togglebar">
      <span class="chip" data-jump="jsonyaml">JSON ⇄ YAML</span>
      <span class="chip" data-jump="csvmd">CSV → Markdown</span>
      <span class="chip" data-jump="epoch">Epoch</span>
      <span class="chip" data-jump="b64">Base64 / URL</span>
      <span class="chip" data-jump="diff">Diff</span>
      <span class="chip" data-jump="pwcheck">Password</span>
    </div>

    <div class="grid">

      <!-- JSON <-> YAML -->
      <div class="card" id="jsonyaml">
        <details open>
          <summary>
            <div class="sum-left">
              <div class="icon">{}</div>
              <div>
                <div class="sum-title">JSON ⇄ YAML Converter</div>
                <div class="hint">Auto-detect input. Pretty JSON + YAML output. Highlights parse errors.</div>
              </div>
            </div>
            <div class="chev">▾</div>
          </summary>

          <div class="content">
            <div class="row">
              <div>
                <label>Paste JSON or YAML here… <span class="hint" id="jyStatus"></span></label>
                <textarea id="jyInput" placeholder='{"hello":"world"}&#10;or&#10;hello: world'></textarea>
                <div class="actions">
                  <div class="left-actions">
                    <button class="btn good" id="jyConvertBtn">Convert</button>
                    <button class="btn secondary" id="jyPrettyBtn" title="Format as pretty JSON (if JSON)">Pretty JSON</button>
                    <button class="btn secondary" id="jyMinifyBtn" title="Minify JSON (if JSON)">Minify JSON</button>
                  </div>
                  <div class="right-actions">
                    <button class="btn secondary" id="jyClearBtn">Clear</button>
                  </div>
                </div>
              </div>

              <div class="arrow">»</div>

              <div>
                <label>Formatted JSON</label>
                <textarea id="jyJsonOut" placeholder="Formatted JSON output…" readonly></textarea>
                <div class="actions">
                  <div class="left-actions">
                    <button class="btn small secondary" data-copy="jyJsonOut">Copy</button>
                  </div>
                  <div class="right-actions">
                    <span class="hint">Readonly</span>
                  </div>
                </div>

                <label style="margin-top:12px;">YAML Output</label>
                <textarea id="jyYamlOut" placeholder="YAML output…" readonly></textarea>
                <div class="actions">
                  <div class="left-actions">
                    <button class="btn small secondary" data-copy="jyYamlOut">Copy</button>
                  </div>
                  <div class="right-actions">
                    <span class="hint">Readonly</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="adslot">[Ad slot placeholder — keep ads minimal and away from the textareas]</div>
          </div>
        </details>
      </div>

      <!-- CSV -> Markdown -->
      <div class="card" id="csvmd">
        <details>
          <summary>
            <div class="sum-left">
              <div class="icon">CSV</div>
              <div>
                <div class="sum-title">CSV → Markdown Table</div>
                <div class="hint">Paste CSV. Outputs GitHub/Obsidian-ready Markdown table.</div>
              </div>
            </div>
            <div class="chev">▾</div>
          </summary>
          <div class="content">
            <div class="row">
              <div>
                <label>Paste CSV data…</label>
                <textarea id="csvInput" placeholder='name,role&#10;Alice,Admin&#10;Bob,Helpdesk'></textarea>
                <div class="actions">
                  <div class="left-actions">
                    <button class="btn good" id="csvConvertBtn">Convert to Markdown</button>
                    <button class="btn secondary" id="csvSampleBtn">Sample</button>
                  </div>
                  <div class="right-actions">
                    <label class="hint" style="margin:0;">
                      <input type="checkbox" id="csvHasHeader" checked style="transform:translateY(1px);"> Header row
                    </label>
                  </div>
                </div>
              </div>

              <div class="arrow">»</div>

              <div>
                <label>Markdown Table Output</label>
                <textarea id="mdOut" placeholder="Markdown table output…" readonly></textarea>
                <div class="actions">
                  <div class="left-actions">
                    <button class="btn small secondary" data-copy="mdOut">Copy</button>
                  </div>
                  <div class="right-actions">
                    <button class="btn secondary" id="csvClearBtn">Clear</button>
                  </div>
                </div>
                <div class="status" id="csvStatus">Ready.</div>
              </div>
            </div>
          </div>
        </details>
      </div>

      <!-- Epoch -->
      <div class="card" id="epoch">
        <details>
          <summary>
            <div class="sum-left">
              <div class="icon">⏱</div>
              <div>
                <div class="sum-title">Epoch / Timestamp Converter</div>
                <div class="hint">Auto-detect seconds / ms / ns. Shows Local + UTC + relative.</div>
              </div>
            </div>
            <div class="chev">▾</div>
          </summary>
          <div class="content">
            <div class="row single">
              <div class="mini">
                <div>
                  <label>Enter timestamp (epoch seconds / ms / ns)</label>
                  <input type="text" id="epochInput" placeholder="e.g. 1735352529 or 1735352529000" />
                  <div class="actions">
                    <div class="left-actions">
                      <button class="btn good" id="epochConvertBtn">Convert</button>
                      <button class="btn secondary" id="epochNowBtn">Use now</button>
                    </div>
                    <div class="right-actions">
                      <button class="btn secondary" id="epochClearBtn">Clear</button>
                    </div>
                  </div>
                  <div class="status" id="epochStatus">Ready.</div>
                </div>

                <div class="kpi">
                  <div><b>Local:</b> <span id="epochLocal">—</span></div>
                  <div><b>UTC:</b> <span id="epochUtc">—</span></div>
                  <div><b>Elapsed:</b> <span id="epochAgo">—</span></div>
                  <hr style="border:0;border-top:1px solid rgba(34,48,88,.6);margin:10px 0;">
                  <div><b>Current epoch (s):</b> <span id="epochNowS">—</span></div>
                  <div><b>Current epoch (ms):</b> <span id="epochNowMs">—</span></div>
                  <div style="margin-top:8px;">
                    <button class="btn small secondary" data-copytext="epochNowS">Copy s</button>
                    <button class="btn small secondary" data-copytext="epochNowMs">Copy ms</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </details>
      </div>

      <!-- Base64 / URL -->
      <div class="card" id="b64">
        <details>
          <summary>
            <div class="sum-left">
              <div class="icon">b64</div>
              <div>
                <div class="sum-title">Base64 / URL Encoder & Decoder</div>
                <div class="hint">UTF-8 safe. Handy for headers, tokens, and quick debugging.</div>
              </div>
            </div>
            <div class="chev">▾</div>
          </summary>
          <div class="content">
            <div class="row">
              <div>
                <label>Encode / decode text…</label>
                <textarea id="b64Input" placeholder="Paste text here…"></textarea>
                <div class="actions">
                  <div class="left-actions">
                    <button class="btn good" id="b64EncodeBtn">Base64 Encode</button>
                    <button class="btn warn" id="b64DecodeBtn">Base64 Decode</button>
                    <button class="btn secondary" id="urlEncodeBtn">URL Encode</button>
                    <button class="btn secondary" id="urlDecodeBtn">URL Decode</button>
                  </div>
                  <div class="right-actions">
                    <button class="btn secondary" id="b64ClearBtn">Clear</button>
                  </div>
                </div>
                <div class="status" id="b64Status">Ready.</div>
              </div>

              <div class="arrow">»</div>

              <div>
                <label>Result</label>
                <textarea id="b64Out" placeholder="Result…" readonly></textarea>
                <div class="actions">
                  <div class="left-actions">
                    <button class="btn small secondary" data-copy="b64Out">Copy</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </details>
      </div>

      <!-- Diff -->
      <div class="card" id="diff">
        <details>
          <summary>
            <div class="sum-left">
              <div class="icon">≠</div>
              <div>
                <div class="sum-title">Text Diff (quick)</div>
                <div class="hint">Line-based comparison for configs and snippets.</div>
              </div>
            </div>
            <div class="chev">▾</div>
          </summary>
          <div class="content">
            <div class="row two">
              <div>
                <label>Text A</label>
                <textarea id="diffA" placeholder="Paste text A…"></textarea>
              </div>
              <div>
                <label>Text B</label>
                <textarea id="diffB" placeholder="Paste text B…"></textarea>
              </div>
            </div>
            <div class="actions" style="margin-top:12px;">
              <div class="left-actions">
                <button class="btn good" id="diffBtn">Compare</button>
                <button class="btn secondary" id="diffSwapBtn">Swap A/B</button>
              </div>
              <div class="right-actions">
                <button class="btn secondary" id="diffClearBtn">Clear</button>
              </div>
            </div>
            <div class="status" id="diffStatus">Ready.</div>

            <div style="margin-top:12px;">
              <label>Differences (A vs B)</label>
              <div class="diffout" id="diffOut" aria-label="Diff output"></div>
              <div class="hint" style="margin-top:8px;">
                Legend: red = only in A, green = only in B, yellow = changed line.
              </div>
            </div>
          </div>
        </details>
      </div>

      <!-- Password Checker -->
      <div class="card" id="pwcheck">
        <details>
          <summary>
            <div class="sum-left">
              <div class="icon">PW</div>
              <div>
                <div class="sum-title">Password Strength Checker (offline)</div>
                <div class="hint">Estimates entropy + crack time. No upload, no storage.</div>
              </div>
            </div>
            <div class="chev">▾</div>
          </summary>

          <div class="content">
            <div class="row single">
              <div>
                <label>
                  Password
                  <span class="hint" id="pwStatus"></span>
                </label>
                <input type="password" id="pwInput" placeholder="Type or paste a password (stays local)..." autocomplete="off" />
                <div class="actions">
                  <div class="left-actions">
                    <button class="btn secondary" id="pwToggleBtn">Show</button>
                    <button class="btn secondary" id="pwGenBtn" title="Generate a strong password locally">Generate</button>
                    <button class="btn secondary" id="pwCopyBtn" title="Copy password">Copy</button>
                  </div>
                  <div class="right-actions">
                    <button class="btn secondary" id="pwClearBtn">Clear</button>
                  </div>
                </div>

                <div class="pwbar" aria-label="Password strength meter" style="margin-top:10px;">
                  <div id="pwBarFill"></div>
                </div>

                <div class="pwgrid">
                  <div class="pwbox">
                    <div><b>Score:</b> <span id="pwScore">—</span><span class="badge" id="pwBadge">—</span></div>
                    <div style="margin-top:6px;"><b>Estimate (bits):</b> <span id="pwEntropy">—</span></div>
                    <div style="margin-top:6px;"><b>Character set:</b> <span id="pwCharset">—</span></div>
                    <div style="margin-top:6px;"><b>Length:</b> <span id="pwLength">—</span></div>
                  </div>

                  <div class="pwbox">
                    <div><b>Estimated crack time</b></div>
                    <div class="hint" style="margin-top:6px;">Illustrative only. Depends on hashing + rate limits.</div>
                    <div style="margin-top:10px;"><b>10k guesses/sec:</b> <span id="pwT10k">—</span></div>
                    <div style="margin-top:6px;"><b>1B guesses/sec:</b> <span id="pwT1b">—</span></div>
                    <div style="margin-top:6px;"><b>100B guesses/sec:</b> <span id="pwT100b">—</span></div>
                  </div>

                  <div class="pwbox">
                    <div><b>Suggestions</b></div>
                    <ul class="pwlist" id="pwTips">
                      <li>Use 14+ characters.</li>
                      <li>Mix upper/lowercase, numbers, symbols.</li>
                      <li>Avoid reused or known-breached passwords.</li>
                    </ul>
                  </div>
                </div>

                <div class="status" id="pwStatusBox" style="margin-top:12px;">Ready.</div>
              </div>
            </div>
          </div>
        </details>
      </div>

    </div>

    <footer>
      <div>Privacy: everything runs locally in your browser. No uploads. No pasted-data storage.</div>
      <div style="margin-top:6px;">
        If you fork or mirror this, keep it lightweight — that’s the whole point.
      </div>
    </footer>
  </div>

  <!-- YAML support (js-yaml). For offline/self-hosting: download and serve locally, then replace this script src. -->
  <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js" crossorigin="anonymous"></script>

  <!-- Password estimation (zxcvbn) -->
  <script src="https://cdn.jsdelivr.net/npm/zxcvbn@4.4.2/dist/zxcvbn.js" crossorigin="anonymous"></script>

  <script>
    // ---------- Utilities ----------
    const $ = (id) => document.getElementById(id);

    function setStatus(el, msg, kind=""){
      el.textContent = msg;
      el.classList.remove("good","bad","warn");
      if(kind) el.classList.add(kind);
    }

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        return true;
      }catch(e){
        const ta = document.createElement("textarea");
        ta.value = text;
        ta.style.position = "fixed";
        ta.style.opacity = "0";
        document.body.appendChild(ta);
        ta.select();
        const ok = document.execCommand("copy");
        document.body.removeChild(ta);
        return ok;
      }
    }

    function escapePipes(s){
      return String(s ?? "").replace(/\|/g, "\\|").replace(/\r?\n/g, " ");
    }

    function parseCSV(text){
      const rows = [];
      let row = [];
      let cur = "";
      let inQuotes = false;

      for(let i=0;i<text.length;i++){
        const ch = text[i];
        const next = text[i+1];

        if(inQuotes){
          if(ch === '"' && next === '"'){ cur += '"'; i++; continue; }
          if(ch === '"'){ inQuotes = false; continue; }
          cur += ch;
          continue;
        }

        if(ch === '"'){ inQuotes = true; continue; }
        if(ch === ","){ row.push(cur); cur=""; continue; }
        if(ch === "\n"){
          row.push(cur); cur="";
          rows.push(row);
          row = [];
          continue;
        }
        if(ch === "\r"){ continue; }

        cur += ch;
      }
      row.push(cur);

      if(!(row.length === 1 && row[0] === "" && rows.length === 0)){
        rows.push(row);
      }
      while(rows.length && rows[rows.length-1].every(c => String(c).trim() === "")){
        rows.pop();
      }
      return rows;
    }

    function csvToMarkdown(rows, hasHeader=true){
      if(!rows.length) return "";
      const colCount = Math.max(...rows.map(r => r.length));
      const norm = rows.map(r => {
        const rr = r.slice();
        while(rr.length < colCount) rr.push("");
        return rr;
      });

      const header = hasHeader ? norm[0] : Array.from({length: colCount}, (_,i)=>`col${i+1}`);
      const body = hasHeader ? norm.slice(1) : norm;

      const headerLine = `| ${header.map(escapePipes).join(" | ")} |`;
      const sepLine = `| ${header.map(()=> "---").join(" | ")} |`;
      const bodyLines = body.map(r => `| ${r.map(escapePipes).join(" | ")} |`);

      return [headerLine, sepLine, ...bodyLines].join("\n");
    }

    function utf8ToB64(str){
      const bytes = new TextEncoder().encode(str);
      let bin = "";
      bytes.forEach(b => bin += String.fromCharCode(b));
      return btoa(bin);
    }
    function b64ToUtf8(b64){
      const bin = atob(b64);
      const bytes = Uint8Array.from(bin, c => c.charCodeAt(0));
      return new TextDecoder().decode(bytes);
    }

    function humanAgo(msDelta){
      const past = msDelta >= 0;
      const ms = Math.abs(msDelta);
      const sec = Math.floor(ms/1000);
      if(sec < 5) return past ? "just now" : "in a moment";
      const mins = Math.floor(sec/60);
      const hrs  = Math.floor(mins/60);
      const days = Math.floor(hrs/24);

      const fmt = (n,u) => `${n} ${u}${n===1?"":"s"}`;
      let out = "";
      if(days>0) out = fmt(days,"day");
      else if(hrs>0) out = fmt(hrs,"hour");
      else if(mins>0) out = fmt(mins,"minute");
      else out = fmt(sec,"second");

      return past ? `${out} ago` : `in ${out}`;
    }

    function detectEpochToMs(input){
      const s = String(input).trim();
      if(!/^-?\d+(\.\d+)?$/.test(s)) return null;

      if(s.includes(".")){
        const sec = Number(s);
        if(!Number.isFinite(sec)) return null;
        return Math.round(sec * 1000);
      }

      const n = BigInt(s);
      const abs = n < 0n ? -n : n;
      const len = abs.toString().length;

      if(len <= 10) return Number(n) * 1000;         // seconds
      if(len <= 13) return Number(n);                // ms
      if(len <= 16) return Number(n / 1000n);        // microseconds -> ms
      return Number(n / 1000000n);                   // nanoseconds -> ms
    }

    function renderLineDiff(aText, bText){
      const a = aText.replace(/\r\n/g,"\n").split("\n");
      const b = bText.replace(/\r\n/g,"\n").split("\n");
      const max = Math.max(a.length, b.length);
      const frag = document.createDocumentFragment();

      for(let i=0;i<max;i++){
        const la = a[i];
        const lb = b[i];
        const el = document.createElement("span");
        el.className = "line";

        if(la === undefined){
          el.classList.add("onlyB");
          el.textContent = `+ [B] ${lb}`;
        } else if(lb === undefined){
          el.classList.add("onlyA");
          el.textContent = `- [A] ${la}`;
        } else if(la === lb){
          el.classList.add("same");
          el.textContent = `  ${la}`;
        } else {
          el.classList.add("diff");
          el.textContent = `~ [A] ${la}\n~ [B] ${lb}`;
        }
        frag.appendChild(el);
      }
      return frag;
    }

    // ---------- Live ticker (UTC / Epoch / Patch Tuesday) ----------
    function nthWeekdayOfMonthUTC(year, monthIndex, weekday, n){
      // weekday: 0=Sun..6=Sat
      const first = new Date(Date.UTC(year, monthIndex, 1, 0, 0, 0));
      const firstDow = first.getUTCDay();
      const delta = (weekday - firstDow + 7) % 7;
      const day = 1 + delta + (n - 1) * 7;
      return new Date(Date.UTC(year, monthIndex, day, 0, 0, 0));
    }

    function nextPatchTuesdayUTC(fromDate){
      // Patch Tuesday = 2nd Tuesday of the month (commonly)
      const y = fromDate.getUTCFullYear();
      const m = fromDate.getUTCMonth();
      const ptThisMonth = nthWeekdayOfMonthUTC(y, m, 2, 2); // Tuesday=2, 2nd occurrence

      // If we're past that day (end of day UTC), move to next month
      const endOfPtDay = new Date(Date.UTC(ptThisMonth.getUTCFullYear(), ptThisMonth.getUTCMonth(), ptThisMonth.getUTCDate(), 23, 59, 59));
      if(fromDate <= endOfPtDay) return ptThisMonth;

      const nextMonth = new Date(Date.UTC(y, m + 1, 1, 0, 0, 0));
      return nthWeekdayOfMonthUTC(nextMonth.getUTCFullYear(), nextMonth.getUTCMonth(), 2, 2);
    }

    function fmtYMDUTC(d){
      const y = d.getUTCFullYear();
      const m = String(d.getUTCMonth()+1).padStart(2,"0");
      const day = String(d.getUTCDate()).padStart(2,"0");
      return `${y}-${m}-${day}`;
    }

    function formatCountdown(ms){
      if(ms <= 0) return "today";
      const totalSec = Math.floor(ms / 1000);
      const days = Math.floor(totalSec / 86400);
      const hrs = Math.floor((totalSec % 86400) / 3600);
      const mins = Math.floor((totalSec % 3600) / 60);

      if(days > 0) return `${days}d ${hrs}h`;
      if(hrs > 0) return `${hrs}h ${mins}m`;
      return `${mins}m`;
    }

    function updateTicker(){
      const now = new Date();
      const nowMs = now.getTime();
      const epochS = Math.floor(nowMs / 1000);

      const utcText = now.toISOString().replace("T"," ").replace("Z"," UTC");
      $("tickUtc").textContent = utcText;
      $("tickEpochS").textContent = String(epochS);
      $("tickEpochMs").textContent = String(nowMs);

      const pt = nextPatchTuesdayUTC(now);
      const msTo = pt.getTime() - nowMs;

      // If it's patch tuesday (UTC date match), show “today”
      const isTodayUTC =
        now.getUTCFullYear() === pt.getUTCFullYear() &&
        now.getUTCMonth() === pt.getUTCMonth() &&
        now.getUTCDate() === pt.getUTCDate();

      const when = isTodayUTC ? "today" : `in ${formatCountdown(msTo)}`;
      $("tickPatch").textContent = `Patch Tuesday: ${fmtYMDUTC(pt)} (${when})`;
    }

    // Copy buttons for ticker
    $("tickCopyUtcBtn").addEventListener("click", async () => {
      const txt = $("tickUtc").textContent || "";
      const ok = await copyText(txt);
      const btn = $("tickCopyUtcBtn");
      const prev = btn.textContent;
      btn.textContent = ok ? "Copied" : "Copy failed";
      setTimeout(()=> btn.textContent = prev, 900);
    });
    $("tickCopyEpochBtn").addEventListener("click", async () => {
      const txt = $("tickEpochS").textContent || "";
      const ok = await copyText(txt);
      const btn = $("tickCopyEpochBtn");
      const prev = btn.textContent;
      btn.textContent = ok ? "Copied" : "Copy failed";
      setTimeout(()=> btn.textContent = prev, 900);
    });

    updateTicker();
    setInterval(updateTicker, 1000);

    // ---------- Global buttons ----------
    $("openAllBtn").addEventListener("click", () => document.querySelectorAll("details").forEach(d=>d.open=true));
    $("closeAllBtn").addEventListener("click", () => document.querySelectorAll("details").forEach(d=>d.open=false));
    $("clearAllBtn").addEventListener("click", () => {
      ["jyInput","jyJsonOut","jyYamlOut","csvInput","mdOut","epochInput","b64Input","b64Out","diffA","diffB","pwInput"].forEach(id => { if($(id)) $(id).value = ""; });
      $("diffOut").textContent = "";
      setStatus($("csvStatus"), "Ready.");
      setStatus($("epochStatus"), "Ready.");
      setStatus($("b64Status"), "Ready.");
      setStatus($("diffStatus"), "Ready.");
      setStatus($("pwStatusBox"), "Ready.");
      $("epochLocal").textContent = "—";
      $("epochUtc").textContent = "—";
      $("epochAgo").textContent = "—";
      resetPwUI();
    });

    document.querySelectorAll(".chip").forEach(ch => {
      ch.addEventListener("click", () => {
        const id = ch.getAttribute("data-jump");
        const el = document.getElementById(id);
        if(el) el.scrollIntoView({behavior:"smooth", block:"start"});
      });
    });

    document.querySelectorAll("[data-copy]").forEach(btn => {
      btn.addEventListener("click", async () => {
        const id = btn.getAttribute("data-copy");
        const el = $(id);
        const ok = await copyText(el.value || "");
        const prev = btn.textContent;
        btn.textContent = ok ? "Copied" : "Copy failed";
        setTimeout(()=> btn.textContent = prev, 900);
      });
    });

    document.querySelectorAll("[data-copytext]").forEach(btn => {
      btn.addEventListener("click", async () => {
        const id = btn.getAttribute("data-copytext");
        const el = $(id);
        const ok = await copyText(el.textContent || "");
        const prev = btn.textContent;
        btn.textContent = ok ? "Copied" : "Copy failed";
        setTimeout(()=> btn.textContent = prev, 900);
      });
    });

    // ---------- JSON/YAML ----------
    const jyStatusEl = $("jyStatus");
    function setJYStatus(msg){ jyStatusEl.textContent = msg ? `(${msg})` : ""; }

    function isLikelyJSON(s){
      const t = s.trim();
      return t.startsWith("{") || t.startsWith("[");
    }

    function convertJsonYaml(){
      const input = $("jyInput").value.trim();
      $("jyJsonOut").value = "";
      $("jyYamlOut").value = "";
      if(!input){
        setJYStatus("paste something");
        return;
      }

      try{
        let obj;
        let mode = "";
        if(isLikelyJSON(input)){
          obj = JSON.parse(input);
          mode = "parsed JSON";
        } else {
          if(typeof jsyaml === "undefined"){
            throw new Error("YAML library not loaded (js-yaml).");
          }
          obj = jsyaml.load(input);
          mode = "parsed YAML";
        }

        $("jyJsonOut").value = JSON.stringify(obj, null, 2);
        $("jyYamlOut").value = (typeof jsyaml !== "undefined")
          ? jsyaml.dump(obj, { noRefs:true, lineWidth: 120 })
          : "YAML support not loaded.";

        setJYStatus(mode);
      }catch(e){
        setJYStatus(`error: ${e.message}`);
      }
    }

    $("jyConvertBtn").addEventListener("click", convertJsonYaml);

    $("jyPrettyBtn").addEventListener("click", () => {
      const v = $("jyInput").value.trim();
      if(!v) return setJYStatus("empty");
      try{
        const obj = JSON.parse(v);
        $("jyInput").value = JSON.stringify(obj, null, 2);
        setJYStatus("pretty JSON");
      }catch(e){
        setJYStatus("not valid JSON");
      }
    });

    $("jyMinifyBtn").addEventListener("click", () => {
      const v = $("jyInput").value.trim();
      if(!v) return setJYStatus("empty");
      try{
        const obj = JSON.parse(v);
        $("jyInput").value = JSON.stringify(obj);
        setJYStatus("minified JSON");
      }catch(e){
        setJYStatus("not valid JSON");
      }
    });

    $("jyClearBtn").addEventListener("click", () => {
      $("jyInput").value = "";
      $("jyJsonOut").value = "";
      $("jyYamlOut").value = "";
      setJYStatus("");
    });

    let jyTimer = null;
    $("jyInput").addEventListener("input", () => {
      clearTimeout(jyTimer);
      jyTimer = setTimeout(convertJsonYaml, 350);
    });

    // ---------- CSV -> MD ----------
    $("csvSampleBtn").addEventListener("click", () => {
      $("csvInput").value = "name,role,team\nAlice,Admin,Infrastructure\nBob,Helpdesk,EUC\nCharlie,SRE,Platform";
    });

    $("csvConvertBtn").addEventListener("click", () => {
      const text = $("csvInput").value;
      try{
        const rows = parseCSV(text);
        if(!rows.length){
          $("mdOut").value = "";
          setStatus($("csvStatus"), "Nothing to convert.", "warn");
          return;
        }
        const md = csvToMarkdown(rows, $("csvHasHeader").checked);
        $("mdOut").value = md;
        setStatus($("csvStatus"), `Converted ${rows.length} row(s).`, "good");
      }catch(e){
        setStatus($("csvStatus"), `Error: ${e.message}`, "bad");
      }
    });

    $("csvClearBtn").addEventListener("click", () => {
      $("csvInput").value = "";
      $("mdOut").value = "";
      setStatus($("csvStatus"), "Ready.");
    });

    // ---------- Epoch ----------
    function updateEpochNow(){
      const now = Date.now();
      $("epochNowS").textContent = String(Math.floor(now/1000));
      $("epochNowMs").textContent = String(now);
    }
    updateEpochNow();
    setInterval(updateEpochNow, 1000);

    function doEpochConvert(){
      const v = $("epochInput").value.trim();
      if(!v){
        setStatus($("epochStatus"), "Enter a timestamp.", "warn");
        $("epochLocal").textContent = "—";
        $("epochUtc").textContent = "—";
        $("epochAgo").textContent = "—";
        return;
      }
      const ms = detectEpochToMs(v);
      if(ms === null || !Number.isFinite(ms)){
        setStatus($("epochStatus"), "Not a valid numeric timestamp.", "bad");
        return;
      }
      const d = new Date(ms);
      if(isNaN(d.getTime())){
        setStatus($("epochStatus"), "Timestamp out of range.", "bad");
        return;
      }

      $("epochLocal").textContent = d.toLocaleString();
      $("epochUtc").textContent = d.toUTCString();
      $("epochAgo").textContent = humanAgo(Date.now() - ms);

      const len = String(v.replace(/[^0-9]/g,"")).length;
      let kind = "milliseconds";
      if(len <= 10) kind = "seconds";
      else if(len <= 13) kind = "milliseconds";
      else if(len <= 16) kind = "microseconds";
      else kind = "nanoseconds";

      setStatus($("epochStatus"), `Parsed as ${kind}.`, "good");
    }

    $("epochConvertBtn").addEventListener("click", doEpochConvert);
    $("epochNowBtn").addEventListener("click", () => {
      $("epochInput").value = String(Date.now());
      doEpochConvert();
    });
    $("epochClearBtn").addEventListener("click", () => {
      $("epochInput").value = "";
      $("epochLocal").textContent = "—";
      $("epochUtc").textContent = "—";
      $("epochAgo").textContent = "—";
      setStatus($("epochStatus"), "Ready.");
    });
    $("epochInput").addEventListener("keydown", (e) => {
      if(e.key === "Enter"){ e.preventDefault(); doEpochConvert(); }
    });

    // ---------- Base64 / URL ----------
    function setB64Out(text, msg, kind="good"){
      $("b64Out").value = text;
      setStatus($("b64Status"), msg, kind);
    }

    $("b64EncodeBtn").addEventListener("click", () => {
      try{
        const t = $("b64Input").value;
        setB64Out(utf8ToB64(t), "Base64 encoded.", "good");
      }catch(e){
        setB64Out("", `Error: ${e.message}`, "bad");
      }
    });

    $("b64DecodeBtn").addEventListener("click", () => {
      try{
        const t = $("b64Input").value.trim();
        setB64Out(b64ToUtf8(t), "Base64 decoded.", "good");
      }catch(e){
        setB64Out("", "Invalid Base64 (or not UTF-8).", "bad");
      }
    });

    $("urlEncodeBtn").addEventListener("click", () => {
      try{
        const t = $("b64Input").value;
        setB64Out(encodeURIComponent(t), "URL encoded.", "good");
      }catch(e){
        setB64Out("", `Error: ${e.message}`, "bad");
      }
    });

    $("urlDecodeBtn").addEventListener("click", () => {
      try{
        const t = $("b64Input").value.trim();
        setB64Out(decodeURIComponent(t), "URL decoded.", "good");
      }catch(e){
        setB64Out("", "Invalid URL encoding.", "bad");
      }
    });

    $("b64ClearBtn").addEventListener("click", () => {
      $("b64Input").value = "";
      $("b64Out").value = "";
      setStatus($("b64Status"), "Ready.");
    });

    // ---------- Diff ----------
    $("diffBtn").addEventListener("click", () => {
      const a = $("diffA").value;
      const b = $("diffB").value;
      const out = $("diffOut");
      out.textContent = "";
      if(!a && !b){
        setStatus($("diffStatus"), "Paste something in A or B.", "warn");
        return;
      }
      out.appendChild(renderLineDiff(a, b));
      setStatus($("diffStatus"), "Compared.", "good");
    });

    $("diffSwapBtn").addEventListener("click", () => {
      const a = $("diffA").value;
      $("diffA").value = $("diffB").value;
      $("diffB").value = a;
    });

    $("diffClearBtn").addEventListener("click", () => {
      $("diffA").value = "";
      $("diffB").value = "";
      $("diffOut").textContent = "";
      setStatus($("diffStatus"), "Ready.");
    });

    // ---------- Password checker (zxcvbn-backed when available) ----------
    function charSpace(pw){
      let space = 0;
      if(/[a-z]/.test(pw)) space += 26;
      if(/[A-Z]/.test(pw)) space += 26;
      if(/[0-9]/.test(pw)) space += 10;
      if(/[^a-zA-Z0-9]/.test(pw)) space += 33;
      if(/[^\x00-\x7F]/.test(pw)) space += 100;
      return space;
    }

    function entropyBits(pw){
      const space = Math.max(charSpace(pw), 1);
      return pw.length * Math.log2(space);
    }

    function clamp(n,min,max){ return Math.min(max, Math.max(min,n)); }

    function formatTime(seconds){
      if(!Number.isFinite(seconds) || seconds <= 0) return "—";
      const units = [
        ["year", 60*60*24*365],
        ["day", 60*60*24],
        ["hour", 60*60],
        ["minute", 60],
        ["second", 1]
      ];
      for(const [name, s] of units){
        const v = Math.floor(seconds / s);
        if(v >= 2) return `${v} ${name}s`;
        if(v === 1) return `1 ${name}`;
      }
      return "< 1 second";
    }

    function scoreLabel(score){
      if(score < 20) return ["Very weak", "bad"];
      if(score < 40) return ["Weak", "warn"];
      if(score < 60) return ["Okay", "warn"];
      if(score < 80) return ["Strong", "good"];
      return ["Very strong", "good"];
    }

    function resetPwUI(){
      $("pwScore").textContent = "—";
      $("pwEntropy").textContent = "—";
      $("pwCharset").textContent = "—";
      $("pwLength").textContent = "—";
      $("pwT10k").textContent = "—";
      $("pwT1b").textContent = "—";
      $("pwT100b").textContent = "—";
      $("pwBadge").textContent = "—";
      $("pwBarFill").style.width = "0%";
      $("pwBarFill").style.background = "rgba(255,107,107,.9)";
      $("pwTips").innerHTML = `
        <li>Use 14+ characters.</li>
        <li>Mix upper/lowercase, numbers, symbols.</li>
        <li>Avoid reused or known-breached passwords.</li>
      `;
      $("pwStatus").textContent = "";
    }

    function guessesToTimes(guesses){
      const rates = {
        "10k guesses/sec": 1e4,
        "1B guesses/sec": 1e9,
        "100B guesses/sec": 1e11
      };
      return {
        t10k: guesses / rates["10k guesses/sec"],
        t1b: guesses / rates["1B guesses/sec"],
        t100b: guesses / rates["100B guesses/sec"]
      };
    }

    function analyzePassword(pw){
      const tips = [];
      const len = pw.length;

      if(len === 0){
        return {
          len: 0, bits: 0, score: 0,
          label: "—", kind: "",
          tips: ["Use 14+ characters.", "Mix upper/lowercase, numbers, symbols.", "Avoid reused or known-breached passwords."],
          t10k: 0, t1b: 0, t100b: 0,
          spaceLabel: "—"
        };
      }

      if(typeof zxcvbn === "function"){
        const z = zxcvbn(pw);
        const score = clamp(Math.round((z.score / 4) * 100), 0, 100);
        const [label, kind] = scoreLabel(score);

        const { t10k, t1b, t100b } = guessesToTimes(Math.max(1, z.guesses));

        const zTips = [];
        if(z.feedback){
          if(z.feedback.warning) zTips.push(z.feedback.warning);
          if(Array.isArray(z.feedback.suggestions)) zTips.push(...z.feedback.suggestions);
        }
        zTips.push("Use a password manager + unique passwords per site.");
        zTips.push("Prefer passphrases (4+ random words) over clever variations.");

        let spaceLabel = [];
        if(/[a-z]/.test(pw)) spaceLabel.push("a-z");
        if(/[A-Z]/.test(pw)) spaceLabel.push("A-Z");
        if(/[0-9]/.test(pw)) spaceLabel.push("0-9");
        if(/[^a-zA-Z0-9]/.test(pw)) spaceLabel.push("symbols");
        if(/[^\x00-\x7F]/.test(pw)) spaceLabel.push("unicode");
        spaceLabel = spaceLabel.join(" + ") || "—";

        const bits = Math.log2(Math.max(1, z.guesses));

        return {
          len, bits, score, label, kind,
          tips: [...new Set(zTips)].slice(0, 6),
          t10k, t1b, t100b,
          spaceLabel
        };
      }

      // fallback
      const bits = entropyBits(pw);

      if(len < 14) tips.push("Use 14+ characters (length matters most).");
      if(!/[A-Z]/.test(pw)) tips.push("Add uppercase letters.");
      if(!/[a-z]/.test(pw)) tips.push("Add lowercase letters.");
      if(!/[0-9]/.test(pw)) tips.push("Add numbers.");
      if(!/[^a-zA-Z0-9]/.test(pw)) tips.push("Add symbols.");

      let score = clamp(Math.round(bits / 1.1), 0, 100);
      const [label, kind] = scoreLabel(score);

      const guesses = Math.pow(2, Math.max(bits - 1, 0));
      const { t10k, t1b, t100b } = guessesToTimes(guesses);

      let spaceLabel = [];
      if(/[a-z]/.test(pw)) spaceLabel.push("a-z");
      if(/[A-Z]/.test(pw)) spaceLabel.push("A-Z");
      if(/[0-9]/.test(pw)) spaceLabel.push("0-9");
      if(/[^a-zA-Z0-9]/.test(pw)) spaceLabel.push("symbols");
      if(/[^\x00-\x7F]/.test(pw)) spaceLabel.push("unicode");
      spaceLabel = spaceLabel.join(" + ") || "—";

      const uniqTips = [...new Set(tips)].slice(0, 6);
      if(uniqTips.length === 0) uniqTips.push("Looks good. Prefer unique passwords per site and a password manager.");

      return { len, bits, score, label, kind, tips: uniqTips, t10k, t1b, t100b, spaceLabel };
    }

    function updatePwUI(){
      const pw = $("pwInput").value || "";
      const r = analyzePassword(pw);

      $("pwScore").textContent = String(r.score);
      $("pwEntropy").textContent = r.bits ? r.bits.toFixed(1) : "0.0";
      $("pwCharset").textContent = r.spaceLabel;
      $("pwLength").textContent = String(r.len);

      $("pwT10k").textContent = formatTime(r.t10k);
      $("pwT1b").textContent = formatTime(r.t1b);
      $("pwT100b").textContent = formatTime(r.t100b);

      $("pwBadge").textContent = r.label;
      $("pwBadge").style.borderColor =
        r.kind === "good" ? "rgba(61,220,151,.45)" :
        r.kind === "warn" ? "rgba(255,204,102,.55)" :
        r.kind === "bad"  ? "rgba(255,107,107,.45)" :
        "rgba(34,48,88,.85)";
      $("pwBadge").style.color =
        r.kind === "good" ? "rgba(61,220,151,.95)" :
        r.kind === "warn" ? "rgba(255,204,102,.95)" :
        r.kind === "bad"  ? "rgba(255,107,107,.95)" :
        "rgba(170,182,214,.85)";

      const pct = clamp(r.score, 0, 100);
      $("pwBarFill").style.width = pct + "%";
      $("pwBarFill").style.background =
        r.kind === "good" ? "rgba(61,220,151,.9)" :
        r.kind === "warn" ? "rgba(255,204,102,.9)" :
        "rgba(255,107,107,.9)";

      $("pwTips").innerHTML = (r.tips || []).map(t => `<li>${t}</li>`).join("");
      $("pwStatus").textContent = pw.length ? "(updates locally)" : "";
      setStatus($("pwStatusBox"), pw.length ? "Analyzing locally. Nothing is uploaded." : "Ready.", pw.length ? "good" : "");
    }

    function generatePassword(){
      const lower = "abcdefghjkmnpqrstuvwxyz";
      const upper = "ABCDEFGHJKMNPQRSTUVWXYZ";
      const digits = "23456789";
      const symbols = "!@#$%^&*()-_=+[]{};:,.?";

      const all = lower + upper + digits + symbols;
      const pick = (s) => s[Math.floor(Math.random()*s.length)];

      let pw = "";
      pw += pick(lower);
      pw += pick(upper);
      pw += pick(digits);
      pw += pick(symbols);

      for(let i=0;i<14;i++) pw += pick(all);

      const arr = pw.split("");
      for(let i=arr.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr.join("");
    }

    let pwShown = false;
    $("pwToggleBtn").addEventListener("click", () => {
      pwShown = !pwShown;
      $("pwInput").type = pwShown ? "text" : "password";
      $("pwToggleBtn").textContent = pwShown ? "Hide" : "Show";
    });
    $("pwGenBtn").addEventListener("click", () => {
      $("pwInput").value = generatePassword();
      updatePwUI();
    });
    $("pwCopyBtn").addEventListener("click", async () => {
      const pw = $("pwInput").value || "";
      if(!pw){
        setStatus($("pwStatusBox"), "Nothing to copy.", "warn");
        return;
      }
      const ok = await copyText(pw);
      setStatus($("pwStatusBox"), ok ? "Copied password to clipboard." : "Copy failed.", ok ? "good" : "bad");
    });
    $("pwClearBtn").addEventListener("click", () => {
      $("pwInput").value = "";
      resetPwUI();
      setStatus($("pwStatusBox"), "Ready.");
    });
    $("pwInput").addEventListener("input", updatePwUI);

    // Init
    resetPwUI();
  </script>
</body>
</html>
